# Nginx 使用域名设置虚拟主机

在真实的上线环境中，一个网站是需要域名和公网 IP 才可以访问的。这也是比较真实的一节课，我们在实际工作中配置最多的就是设置这种虚拟主机。

如果你还没有域名，我希望你也能注册一个，你可以注册一个以你名字全拼的域名，这类域名资源还是比较丰富的。一年才几十元钱，这不仅仅是为了学习这篇课程，更重要是有一个域名会对你的职业发展有很多好处。比如你自己作的程序想展示给别人看，你自己要建立一个博客，或者是你要进行一个程序测试，这些都需要域名的支持。所以如果你是一名程序员，我强烈建议你能申请一个自己的域名。

我这里就使用自己的博客域名作例子了。

先要对域名进行解析，这样域名才能正确定位到你需要的 IP 上。 我这里新建了两个解析，分别是:

- nginx.xxx.com :这个域名映射到默认的 Nginx 首页位置。
- nginx2.xxx.com : 这个域名映射到原来的 8001 端口的位置。

## 配置以域名为划分的虚拟主机

我们修改 etc/nginx/conf.d 目录下的 default.conf 文件，把原来的 80 端口虚拟主机改为以域名划分的虚拟主机。代码如下：

```shell
server {
  listen       80;
  server_name  nginx.jspang.com;
}
```

我们再把同目录下的 8001.conf 文件进行修改，改成如下：

```shell
server{
  listen 80;
  server_name nginx2.jspang.com;
  location / {
    root /usr/share/nginx/html/html8001;
    index index.html index.htm;
  }
}
```

然后我们用平滑重启的方式，进行重启，这时候我们在浏览器中访问这两个网页。

其实域名设置虚拟主机也非常简单，主要操作的是配置文件的 server_name 项，还需要域名解析的配合。
