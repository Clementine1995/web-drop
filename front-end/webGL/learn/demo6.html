<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>绘制线段</title>
  <style type="text/css">
    .option {
      position: fixed;
      top: 20px;
      right: 20px;
      color: #FFF;
    }
  </style>
</head>

<body>
  <canvas id="canvas" width="1000" height="800"></canvas>
  <script type="shader-source" id="vertexShader">
    precision mediump float;
    // 接收顶点坐标 (x, y)
    attribute vec2 a_Position;
    // 接收 canvas 尺寸(width, height)
    attribute vec2 a_Screen_Size;
    // 接收JavaScript传递过来的顶点 uv 坐标。
    attribute vec2 a_Uv;
    // 将接收的uv坐标传递给片元着色器
    varying vec2 v_Uv;
    void main(){
      vec2 position = (a_Position / a_Screen_Size) * 2.0 - 1.0;
      position = position * vec2(1.0,-1.0);
      gl_Position = vec4(position, 0, 1);
      // 将接收到的uv坐标传递给片元着色器
      v_Uv = a_Uv;
    }
	</script>
  <script type="shader-source" id="fragmentShader">
    precision mediump float;
    // 接收顶点着色器传递过来的 uv 值。
    varying vec2 v_Uv;
    // 接收 JavaScript 传递过来的纹理
    uniform sampler2D texture;
    void main(){
      // 提取纹理对应uv坐标上的颜色，赋值给当前片元（像素）。
        gl_FragColor = texture2D(texture, vec2(v_Uv.x, v_Uv.y));
    }
	</script>
  <script src="webgl-helper.js"></script>
  <script>
    //获取canvas
    let canvas = getCanvas("#canvas");
    //设置canvas尺寸为满屏
    resizeCanvas(canvas);
    //获取绘图上下文
    let gl = getContext(canvas);
    //创建着色器程序
    let program = createSimpleProgramFromScript(
      gl,
      "vertexShader",
      "fragmentShader"
    );

    //使用该着色器程序
    gl.useProgram(program);

    var positions = [
      30, 30, 0, 0, //V0
      30, 300, 0, 1, //V1
      300, 300, 1, 1, //V2
      30, 30, 0, 0, //V0
      300, 300, 1, 1, //V2
      300, 30, 1, 0 //V3
    ]

    // 随机生成一个颜色。
    var color = randomColor();
    // 找到着色器中的全局变量 u_Color;
    var u_Texture = gl.getUniformLocation(program, "u_Texture");
    var u_Screen_Size = gl.getUniformLocation(program, "u_Screen_Size");
    gl.uniform2f(u_Screen_Size, canvas.width, canvas.height);
    var a_Position = gl.getAttribLocation(program, "a_Position");
    var a_Uv = gl.getAttribLocation(program, "a_Uv");
    gl.enableVertexAttribArray(a_Position);
    gl.enableVertexAttribArray(a_Uv);
  </script>
</body>

</html>